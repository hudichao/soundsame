webpackJsonp([2,0],[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var s=n(38),i=o(s),a=n(97),u=o(a);new i["default"]({el:"body",components:{App:u["default"]}})},,,,,,,,,function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.saveMessage=t.initList=t.deleteSong=t.raiseSong=t.cutSong=t.addSong=t.searchSong=t.url=t.wsUrl=void 0;var s=n(10),i=o(s),a=n(48),u=o(a),r=n(90),c=o(r),d=function(e){return new u["default"](function(t,n){c["default"].ajax(e).then(function(e){t(e)},function(e){n(e)})})},l=t.wsUrl="ws://120.55.93.6:3333",f=t.url="http://120.55.93.6:3333",g=new WebSocket(l);t.searchSong=function(e){return new u["default"](function(t,n){d({url:"http://115.29.195.14:8083/cmusic",data:{song_url:e},dataType:"json"}).then(function(e){var n=[];e.forEach(function(e){n.push({name:e.title,src:e.location,image:e.pic,song_id:e.song_id})}),t(n)})})},t.addSong=function(e){return d({url:f+"/api/addSong",data:{song_id:e.song_id,name:e.name,src:e.src,image:e.image}})},t.cutSong=function(){return d({url:f+"/api/cutSong"})},t.raiseSong=function(e){return d({url:f+"/api/raiseSong",data:{id:e}})},t.deleteSong=function(e){return d({url:f+"/api/removeSong",data:{id:e}})},t.initList=function(e){return d({url:f+"/api/initList",data:{room_id:e},dataType:"json"})},t.saveMessage=function(e){g.send((0,i["default"])({type:"CHAT",data:e}))}},,,,,,function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.initSongs=t.raiseSong=t.deleteSong=t.cutSong=t.addSong=t.getMusic=t.getMessage=void 0;var s=n(9),i=o(s),a=n(17),u=o(a);t.getMessage=function(e,t){var n=e.dispatch;e.state;n(u.GET_MESSAGE,t)},t.getMusic=function(e,t){var n=e.dispatch;e.state;console.log(u["REMOTE_"+t.type]),n(u["REMOTE_"+t.type],t.data)},t.addSong=function(e,t){e.dispatch,e.state;i.addSong(t)},t.cutSong=function(e){e.dispatch,e.state;i.cutSong()},t.deleteSong=function(e,t){e.dispatch,e.state;i.deleteSong(t)},t.raiseSong=function(e,t){e.dispatch,e.state;i.raiseSong(t)},t.initSongs=function(e,t){var n=e.dispatch,o=(e.state,2);i.initList(o).then(function(e){n(u.INIT_SONGS,e)})}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.music=function(e){return e.music.music},t.messages=function(e){return e.message.messages},t.songs=function(e){return e.music.songs},t.activeSong=function(e){return e.music.activeSong},t.oldSongs=function(e){return e.music.oldSongs}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GET_MESSAGE="获取文本信息",t.REMOTE_ADD_ACTIVE_SONG="歌曲加入当前播放",t.REMOTE_ADD_SONG="歌曲加入歌单",t.REMOTE_CUT_SONG="切歌",t.REMOTE_DELETE_SONG="删歌",t.REMOTE_RAISE_SONG="顶歌",t.INIT_SONGS="初始化歌曲列表"},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(26),i=o(s),a=n(10),u=o(a),r=n(17),c={messages:[]},d=(0,i["default"])({},r.GET_MESSAGE,function(e,t){e.messages.push(t),console.log((0,u["default"])(e.messages))});t["default"]={state:c,mutations:d}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var s,i=n(26),a=o(i),u=n(10),r=o(u),c=n(17),d=n(91),l=o(d),f={songs:[],oldSongs:[],activeSong:{name:"",src:"",song_id:"",id:""}},g=(s={},(0,a["default"])(s,c.REMOTE_ADD_ACTIVE_SONG,function(e,t){e.activeSong=t}),(0,a["default"])(s,c.REMOTE_ADD_SONG,function(e,t){e.songs.push(t)}),(0,a["default"])(s,c.REMOTE_CUT_SONG,function(e,t){e.activeSong&&e.oldSongs.push(e.activeSong),t.id?(e.activeSong=t,g[c.REMOTE_DELETE_SONG](e,t.id)):(e.activeSong={},console.log("no song in queue"))}),(0,a["default"])(s,c.REMOTE_DELETE_SONG,function(e,t){var n=l["default"].findIndex(e.songs,{id:t});n>-1&&e.songs.splice(n,1)}),(0,a["default"])(s,c.REMOTE_RAISE_SONG,function(e,t){var n=l["default"].findIndex(JSON.parse((0,r["default"])(e.songs)),{id:t});if(n>-1){var o=e.songs.splice(n,1)[0];e.songs.unshift(o)}}),(0,a["default"])(s,c.INIT_SONGS,function(e,t){console.log("init songs"),e.songs=t.songs||[],e.oldSongs=t.oldSongs||[],e.activeSong=t.activeSong||{}}),s);t["default"]={state:f,mutations:g}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(38),i=o(s),a=n(102),u=o(a),r=n(39),c=o(r),d=n(40),l=o(d),f=n(103),g=o(f);i["default"].use(u["default"]);var p=!1;t["default"]=new u["default"].Store({modules:{message:c["default"],music:l["default"]},strict:!0,middlewares:p?[(0,g["default"])()]:[]})},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(41),a=s(i),u=n(100),r=s(u),c=n(99),d=s(c),l=n(98),f=s(l),g=n(9),p=o(g);t["default"]={data:function(){return{ws:new window.WebSocket(p.wsUrl)}},store:a["default"],created:function(){var e=this,t=function(e){},n=function(t){console.log(t.data),e.$broadcast("wsmessage",JSON.parse(t.data))},o=function(e){console.log("server was closed")};this.ws.onopen=t,this.ws.onmessage=n,this.ws.onclose=o},components:{musicArea:r["default"],messageArea:d["default"],listArea:f["default"]}}},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),a=s(i),u=n(9),r=o(u),c=n(15),d=n(16);t["default"]={data:function(){return{input:"",searchResult:[],showSearchResult:!1,showOldSongs:!1}},methods:{search:function(){var e=this;r.searchSong(this.input).then(function(t){e.searchResult=t?t.slice(0,5):[],e.showSearchResult=!0})},add:function(e){this.showSearchResult=!1,this.addSong(e)},raise:function(e){this.raiseSong(e.id)},remove:function(e){this.deleteSong(e.id)},showOld:function(){this.showOldSongs=!this.showOldSongs}},events:{wsmessage:function(e){console.log("获取"+(0,a["default"])(e)+"!!!!");var t=["ADD_SONG","CUT_SONG","RAISE_SONG","DELETE_SONG","ADD_ACTIVE_SONG"];t.indexOf(e.type)>-1&&this.getMusic(e)}},ready:function(){this.initSongs()},vuex:{getters:{songs:d.songs,activeSong:d.activeSong,oldSongs:d.oldSongs},actions:{addSong:c.addSong,deleteSong:c.deleteSong,raiseSong:c.raiseSong,initSongs:c.initSongs,getMusic:c.getMusic}}}},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var s=n(15),i=n(16),a=n(9),u=o(a);t["default"]={data:function(){return{message:{name:"ha",body:"",time:null}}},methods:{send:function(){this.message.time=new Date,u.saveMessage(this.message),this.message.body=""}},events:{wsmessage:function(e){"CHAT"===e.type&&(console.log(e),this.getMessage(e.data))}},vuex:{getters:{messages:i.messages},actions:{getMessage:s.getMessage}},ready:function(){}}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(101),i=o(s),a=n(16),u=n(15);t["default"]={components:{sound:i["default"]},data:function(){return{currentTime:0}},methods:{cut:function(){console.log("cut!"),this.currentTime=0,this.cutSong()}},ready:function(){},vuex:{actions:{cutSong:u.cutSong},getters:{activeSong:a.activeSong}}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={props:{activeSong:{type:Object}},data:function(){return{audio:null}},ready:function(){var e=this;this.audio=this.$el,this.audio.onended=function(){console.log("歌曲自然结束"),e.$dispatch("song-end")}},watch:{activeSong:function(e){e&&(this.audio.pause(),e.src&&(this.audio.src=e.src,e.startTime&&(this.audio.currentTime=(Date.now()-e.startTime)/1e3),this.audio.play()))}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,function(e,t){e.exports=" <div id=app> <music-area></music-area> <list-area></list-area> <message-area></message-area> </div> "},function(e,t){e.exports=' <div class=listArea> <div class=search> <form> <input type=text v-model=input> <button type=submit @click.prevent=search()>搜索歌曲</button> <button @click.prevent=showOld() :class="{active: showOldSongs}">歌曲历史</button> </form> <div class=searchResult v-show=showSearchResult> <div v-if="searchResult.length > 0"> <span class=one-song v-for="one in searchResult" track-by=song_id> {{one.name}}<button @click=add(one)>加入歌单</button> </span> </div> <div v-else> <span>没有找到歌曲！</span> </div> </div> <div class=songList v-for="song in oldSongs" track-by=$index v-if=showOldSongs> <span class=one-song>{{song.name}} <button @click=add(song)>加入歌单</button> </span> </div> <div class=songList> <span class=one-song v-if=activeSong.name>正在播放~~~~~{{activeSong.name}}</span> <span class=one-song v-for="song in songs" track-by=id>{{song.name}} <button @click=remove(song)>删</button> <button @click=raise(song)>顶</button> </span> </div> </div> </div> '},function(e,t){e.exports=' <div class=messageArea> <ul> <li v-for="one in messages" track-by=$index> <span class=name>{{one.name}}</span> <span class=body>{{one.body}}</span> </li> </ul> <div class=inputArea> <form> <input type=text v-model=message.body> <button type=submit @click.prevent=send()>发送</button> </form> </div> </div> '},function(e,t){e.exports=" <div class=songArea> <sound :active-song=activeSong v-on:song-end=cut></sound> <div class=actionArea> <button @click=cut()>切！！！！！！！！！！！！</button> </div> </div> "},function(e,t){e.exports=" <audio controls> <source type=audio/mpeg> </audio> "},function(e,t,n){var o,s;n(85),o=n(42),s=n(92),e.exports=o||{},e.exports.__esModule&&(e.exports=e.exports["default"]),s&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=s)},function(e,t,n){var o,s;n(86),o=n(43),s=n(93),e.exports=o||{},e.exports.__esModule&&(e.exports=e.exports["default"]),s&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=s)},function(e,t,n){var o,s;n(87),o=n(44),s=n(94),e.exports=o||{},e.exports.__esModule&&(e.exports=e.exports["default"]),s&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=s)},function(e,t,n){var o,s;n(88),o=n(45),s=n(95),e.exports=o||{},e.exports.__esModule&&(e.exports=e.exports["default"]),s&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=s)},function(e,t,n){var o,s;n(89),o=n(46),s=n(96),e.exports=o||{},e.exports.__esModule&&(e.exports=e.exports["default"]),s&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=s)}]);
//# sourceMappingURL=app.489caaa0cb7a8250b6b9.js.map